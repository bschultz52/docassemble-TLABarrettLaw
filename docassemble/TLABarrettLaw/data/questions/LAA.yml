objects:
  - user: Individual
  - cohabs: DAList.using(object_type=Individual)
  - family_members: DAList.using(object_type=Individual)
---
mandatory: true
code: |
  # Code-flow block

  
---
mandatory: true
question: Results
subquestion:   |

  Dear, ${ user }.
  
  % if user_eligible:
  You are eligible for Legal Aid
  % endif
 
  % if No_Lawyer:
  You currently do not have a Legal Representation
  % endif
 
  % if Cannot_Afford_Lawyer:
  You cannot currently afford legal representation.
  % if Lawyer_Is_Acting:
  You are currently still represented by a lawyer.
  % endif
  % endif

  % if In_Alberta:
  Your legal matter is in Alberta.
  % endif
  
  % if Lives_In_Alberta:
  You are also currently living in Alberta.
  % endif
  
  % if Received_Laa_Assistance:
  You have received LAA Assitance on this matter in the past.
  % else:
  
  % if Criminal_Matter:
  This is a criminal law matter
  % endif
  
  % if Family_Matter:
  This is a family law matter
  % endif
  % endif

attachments:
  - name: Summary of Benefits
    filename: benefits_summary
    content: |
      Hello, ${ user }.
      
      % if len(family_members) > 0:
      
      The family members you told me about are: ${ family_members }.
      
      % for f in family_members:
      
      ${ f } sounds great.
      
      %endfor
      
      I'm a particularly big fan of ${ family_members[0] }.
      
      % else:
      
      You didn't tell me about any family members.
      
      % endif
      
      Your signature? ${ user.signature }
---
code: |
  # Unrepped 
    
  if No_Lawyer and Cannot_Afford_Lawyer:
    user_not_reped = True 
  else: 
    user_not_reped = False
---
code: |
  # Resident  
    
  if In_Alberta and Lives_In_Alberta:
    user_resident = True 
  else:
    user_resident = False
---
code: |
  # Eligibility 
    
  if Received_Laa_Assistance or (user_not_reped and user_resident and Criminal_Matter) or (user_not_reped and user_resident and Family_Matter):
    user_eligible = True 
  else:
    user_eligible = False 
---
generic object: Individual
question: |
  What is ${x.object_possessive('name') }?
fields:
  - First Name: x.name.first
  - Last Name: x.name.last
---
question: Do you have any family members?
yesno: family_members.there_are_any
---
question: Do you have any additional family members?
yesno: family_members.there_is_another
---
question: Do you live with anyone?
yesno: cohabs.there_are_any
---
question: Do you live with anyone else?
yesno: cohabs.there_is_another
--- 
question: Please sign
signature: user.signature
---
question: Do you have a lawyer?
noyes: No_Lawyer
---
question: Can you afford a lawyer?
noyes: Cannot_Afford_Lawyer
---
question: Is your lawyer still acting for you in this matter?
yesno: Lawyer_Is_Acting
---
question: Is your matter in Alberta?
yesno: In_Alberta
---
question: Do you live in Alberta?
yesno: Lives_In_Alberta
--- 
question: Is this a family law matter?
yesno: Family_Matter
---
question: Is this a criminal law matter?
yesno: Criminal_Matter
---
question: Is this an appeal of another LAA matter?
yesno: Received_Laa_Assistance